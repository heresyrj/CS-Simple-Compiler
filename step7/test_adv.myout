;LABEL main
;LINK
;STOREF 0.0001 $T1
;STOREF $T1 tolerance
;STOREF 7.0 $T2
;STOREF $T2 num
;STOREF num approx
;STOREI 0 $T3
;STOREI $T3 count
;STOREF 0.0 $T4
;STOREF $T4 diff
;STOREI 0 $T5
;STOREI $T5 enough
;LABEL label1
;STOREI 1 $T6
;EQ enough $T6 label2
;STOREI 1 $T7
;ADDI count $T7 $T8
;STOREI $T8 count
;STOREF 0.5 $T9
;DIVF num approx $T10
;ADDF approx $T10 $T11
;MULTF $T9 $T11 $T12
;STOREF $T12 newapprox
;SUBF approx newapprox $T13
;STOREF $T13 diff
;STOREF 0.0 $T14
;LE diff $T14 label4
;GE diff tolerance label6
;STOREI 1 $T15
;STOREI $T15 enough
;JUMP label5
;LABEL label6
;LABEL label5
;JUMP label3
;LABEL label4
;STOREF 0.0 $T16
;SUBF $T16 tolerance $T17
;LE diff $T17 label8
;STOREI 1 $T18
;STOREI $T18 enough
;JUMP label7
;LABEL label8
;LABEL label7
;LABEL label3
;STOREF newapprox approx
;JUMP label1
;LABEL label2
;WRITEF approx
;WRITEI count
;RET

var num 
var count 
var diff 
var enough 
var newapprox 
var tolerance 
var approx 
push  
push r0 
push r1 
push r2 
push r3 
jsr main 
sys halt 
label main 
link 18 
move 0.0001 r2
move r2 tolerance
move 7.0 r3
move r3 num
move num r0
move r0 approx
move 0 r1
move r1 count
move $T4 r2
move 0.0 r2
move r2 diff
move $T5 r2
move 0 r2
move r2 enough
label label1 
move 1 r2
cmpr enough r2
jeq label2 
move 1 r3
move r3 r0
addi count r0
move r0 count
move 0.5 r1
move $T10 r2
move approx r2
divr num r2
move $T11 r3
move r2 r3
addr approx r3
move $T12 r2
move r3 r2
mulr r1 r2
move r2 newapprox
move $T13 r2
move newapprox r2
subr approx r2
move r2 diff
move $T14 r2
move 0.0 r2
cmpr diff r2
jle label4 
move diff r2
move diff r2
cmpr tolerance r2
jge label6 
move $T15 r2
move 1 r2
move r2 enough
jmp label5 
label label6 
label label5 
jmp label3 
label label4 
move 0.0 r2
move tolerance r3
subr r2 r3
cmpr diff r3
jle label8 
move 1 r0
move r0 enough
jmp label7 
label label8 
label label7 
label label3 
move newapprox r2
move r2 approx
jmp label1 
label label2 
sys writer approx
sys writei count
unlnk  
ret  
end