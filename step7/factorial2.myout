;LABEL factorial
;LINK
;STOREI 1 $T1
;NE $P1 $T1 label2
;STOREI 1 $T2
;STOREI $T2 $R
;RET
;JUMP label1
;LABEL label2
;STOREI 1 $T3
;SUBI $P1 $T3 $T4
;PUSH
;PUSH $T4
;JSR factorial
;POP
;POP $T5
;STOREI $T5 $L2
;MULTI $L2 $P1 $T6
;STOREI $T6 $L1
;LABEL label1
;STOREI $L1 $R
;RET
;LABEL main
;LINK
;WRITES input
;READI $L1
;STOREI 1 $T7
;NE $L1 $T7 label4
;STOREI 1 $T8
;STOREI $T8 $L2
;JUMP label3
;LABEL label4
;STOREI 1 $T9
;LE $L1 $T9 label6
;PUSH
;PUSH $L1
;JSR factorial
;POP
;POP $T10
;STOREI $T10 $L2
;JUMP label5
;LABEL label6
;STOREI 0 $T11
;STOREI $T11 $L2
;LABEL label5
;LABEL label3
;WRITEI $L2
;WRITES eol
;STOREI 0 $T12
;STOREI $T12 $R
;RET
str eol "\n"
str input "Please enter an integer number: "
push  
push r0 
push r1 
push r2 
push r3 
jsr main 
sys halt 
label factorial 
link 8 
move 1 r2
cmpi $6 r2
jne label2 
move 1 r3
move r3 $7
unlnk  
ret  
jmp label1 
label label2 
move 1 r2
move r2 r3
subi $6 r3
push  
push r3 
push r0 
push r1 
push r2 
push r3 
jsr factorial 
pop r3 
pop r2 
pop r1 
pop r0 
pop  
pop r2 
move r2 $-2
move $6 r3
muli $-2 r3
move r3 $-1
label label1 
move $-1 r2
move r2 $7
unlnk  
ret  
label main 
link 8 
sys writes input
sys readi $-1
move 1 r2
cmpi $-1 r2
jne label4 
move 1 r3
move r3 $-2
jmp label3 
label label4 
move 1 r2
cmpi $-1 r2
jle label6 
push  
push $-1 
push r0 
push r1 
push r2 
push r3 
jsr factorial 
pop r3 
pop r2 
pop r1 
pop r0 
pop  
pop r2 
move r2 $-2
jmp label5 
label label6 
move 0 r2
move r2 $-2
label label5 
label label3 
sys writei $-2
sys writes eol
move 0 r2
move r2 $6
unlnk  
ret  
end